<ion-header>
  <ion-toolbar>
    <ion-title>Detalles del Entrenamiento</ion-title>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/workouts"></ion-back-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-button [routerLink]="['/edit-workout', workoutId]">
        <ion-icon name="create-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ng-container *ngIf="workout; else loading">
    
    <!-- Estado del entrenamiento -->
    <ion-item lines="none" *ngIf="workout.completed">
      <ion-badge color="success" slot="end">
        <ion-icon name="checkmark-outline"></ion-icon>
        Completado
      </ion-badge>
    </ion-item>
    
    <ion-item lines="none" *ngIf="!workout.completed && isScheduledSoon()">
      <ion-badge color="warning" slot="end">
        <ion-icon name="time-outline"></ion-icon>
        Próximamente
      </ion-badge>
    </ion-item>
    
    <ion-item lines="none" *ngIf="isPastDue()">
      <ion-badge color="danger" slot="end">
        <ion-icon name="alert-outline"></ion-icon>
        Vencido
      </ion-badge>
    </ion-item>

    <!-- Información principal -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>{{ workout.title }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item lines="none">
          <ion-icon name="document-text-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Descripción</h3>
            <p>{{ workout.description }}</p>
          </ion-label>
        </ion-item>

        <ion-item lines="none">
          <ion-icon name="calendar-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Programado para</h3>
            <p>{{ workout.scheduledAt | date:'full' }}</p>
          </ion-label>
        </ion-item>

        <ion-item lines="none" *ngIf="workout.latitude && workout.longitude">
          <ion-icon name="location-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Ubicación</h3>
            <p>{{ workout.latitude }}, {{ workout.longitude }}</p>
          </ion-label>
          <ion-button 
            slot="end" 
            fill="outline" 
            size="small"
            (click)="openInMaps()">
            Ver en Mapa
          </ion-button>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <!-- Acciones -->
    <div class="ion-margin-top">
      <ion-button 
        *ngIf="!workout.completed" 
        expand="block" 
        color="success"
        (click)="markAsComplete()">
        <ion-icon slot="start" name="checkmark-outline"></ion-icon>
        Marcar como Completado
      </ion-button>

      <ion-button 
        *ngIf="workout.completed" 
        expand="block" 
        color="medium"
        disabled>
        <ion-icon slot="start" name="checkmark-circle-outline"></ion-icon>
        Entrenamiento Completado
      </ion-button>
    </div>

    <!-- Información adicional -->
    <ion-card class="ion-margin-top">
      <ion-card-header>
        <ion-card-subtitle>Información Adicional</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <ion-item lines="none" *ngIf="workout.createdAt">
          <ion-icon name="add-circle-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Creado</h3>
            <p>{{ workout.createdAt | date:'medium' }}</p>
          </ion-label>
        </ion-item>

        <ion-item lines="none" *ngIf="workout.updatedAt">
          <ion-icon name="create-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Última actualización</h3>
            <p>{{ workout.updatedAt | date:'medium' }}</p>
          </ion-label>
        </ion-item>

        <ion-item lines="none" *ngIf="workout.completedAt">
          <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Completado el</h3>
            <p>{{ workout.completedAt | date:'medium' }}</p>
          </ion-label>
        </ion-item>
      </ion-card-content>
    </ion-card>

  </ng-container>

  <ng-template #loading>
    <div class="ion-text-center ion-margin-top">
      <ion-spinner></ion-spinner>
      <p>Cargando entrenamiento...</p>
    </div>

